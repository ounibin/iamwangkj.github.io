<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>深入了解-h5中的video标签 | wangkj的笔记</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="video标签的自动播放，https:&#x2F;&#x2F;developer.chrome.com&#x2F;blog&#x2F;autoplay&#x2F;在静音情况下是可以的，但不是静音情况，需要用户交互后，才能播放。 直播流：HTML5中video标签播放m3u8，遇到问题是：PC机上浏览器都不能访问（IE11，Chrome，Firefox，Opera，Safari），但安卓手机中的浏览器可以正常使用。 m3u8在chrome不能播放，">
<meta property="og:type" content="article">
<meta property="og:title" content="深入了解-h5中的video标签">
<meta property="og:url" content="https://iamwangkj.github.io/2022/04/29/%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3-h5%E4%B8%AD%E7%9A%84video%E6%A0%87%E7%AD%BE/index.html">
<meta property="og:site_name" content="wangkj的笔记">
<meta property="og:description" content="video标签的自动播放，https:&#x2F;&#x2F;developer.chrome.com&#x2F;blog&#x2F;autoplay&#x2F;在静音情况下是可以的，但不是静音情况，需要用户交互后，才能播放。 直播流：HTML5中video标签播放m3u8，遇到问题是：PC机上浏览器都不能访问（IE11，Chrome，Firefox，Opera，Safari），但安卓手机中的浏览器可以正常使用。 m3u8在chrome不能播放，">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-04-29T10:20:16.000Z">
<meta property="article:modified_time" content="2022-12-20T17:06:14.587Z">
<meta property="article:author" content="wangkj">
<meta property="article:tag" content="深入了解系列">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="wangkj的笔记" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">wangkj的笔记</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- 
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
         -->
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://iamwangkj.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="categories-深入了解-h5中的video标签" class="h-entry article article-type-categories" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/04/29/%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3-h5%E4%B8%AD%E7%9A%84video%E6%A0%87%E7%AD%BE/" class="article-date">
  <time class="dt-published" datetime="2022-04-29T10:20:16.000Z" itemprop="datePublished">2022-04-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      深入了解-h5中的video标签
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>video标签的自动播放，<a target="_blank" rel="noopener" href="https://developer.chrome.com/blog/autoplay/">https://developer.chrome.com/blog/autoplay/</a><br>在静音情况下是可以的，但不是静音情况，需要用户交互后，才能播放。</p>
<p>直播流：<br>HTML5中video标签播放m3u8，遇到问题是：PC机上浏览器都不能访问（IE11，Chrome，Firefox，Opera，Safari），但安卓手机中的浏览器可以正常使用。</p>
<p>m3u8在chrome不能播放，jdapp中可以。</p>
<p>华为 Nova5 Pro安卓9<br>谷歌手机，安卓12WiFi环境下，无静音键，不自动播放<br>安卓11系统的是小米11，WiFi环境下，无静音键，不自动播放</p>
<p>原生video：<br>1、在ios13低电量时，不自动播放，不展示默认封面，而是展示了一个按钮，点击再播放。<br>2、如果没视频url，有封面，却展示不能播放的视频，而不是封面。<br>3、如在ios10以下，展示了播放按钮，上面有一斜杠（不能播放）<br>4、video在低系统版本（ios10以下，安卓7以下）可能有播放按钮、弹窗等。<br>5、video在jd-app省电模式会不播放（app默认行为）<br>6、页面不可见时，如切换、滑动，需要暂停播放<br>7、在jd-小程序，不能自动静音播放<br>8、新的策略，可以静音自动播放（<a target="_blank" rel="noopener" href="https://developer.chrome.com/blog/autoplay/#webaudio%EF%BC%89%EF%BC%8C%E4%B8%8D%E7%84%B6%EF%BC%8C%E9%9C%80%E8%A6%81%E4%BA%A4%E4%BA%92%E5%90%8E%E6%89%8D%E6%92%AD%E6%94%BE">https://developer.chrome.com/blog/autoplay/#webaudio），不然，需要交互后才播放</a><br>9、直播的产品经理说：不建议4G自动播放，需要用户点击播放按钮再播放，不然会有偷流量的嫌疑（有客诉说在偷流量），影响用户体验，而wifi下可以自动播放<br>10、小米mix3，安卓9，jd-app，内联视频在最顶层，挡住了利益点，并且出现播放进度条，并且设置了充满屏幕也没有生效</p>
<p>总结：<br>1、在有src、jd-app内（非省电模式）、安卓 7以上、IOS 10以上、非小米mix3、wifi环境下，才播放视频，其他的只展示模拟封面。<br>this.canPlay = this.$env.JD &amp;&amp; src &amp;&amp; (versionCompare(getIOSVersion(), ‘10.0.0’) &gt; 0 || versionCompare(getAndroidVersion(), ‘7.0.0’) &gt; 0)<br>2、需要我们自己去模拟封面，代码监听播放进度，能播就自动静音播放，不能就展示模拟封面。</p>
<p>const isMIX3 = navigator.userAgent.includes(‘model/MIX 3’)</p>
<p>内联视频：<br>playsinline， iOS10以上（该属性一定要，x5内核也要）<br>webkit-playsinline， iOS10以下，做适配最好两个都添加</p>
<p>x5-video-player-type=’h5’，解决了视频层级过高的问题，但出现了点击播放自动进入全屏的问题。因此还需要监听x5的全屏事件进行适配<br>x5-video-player-type=’h5-page’， 解决了视频层级过高的问题，视频播放也不会立刻进入全屏状态</p>
<p>x5-video-player-fullscreen=”true”， 视频播放时将会进入到全屏模式，如果不申明此属性，页面得到视口区域为原始视口大小(视频未播放前)，比如在微信里，会有一个常驻的标题栏，如果不声明此属性，这个标题栏高度不会给页面，播放时会平均分为两块（上下黑块）<br>x5-video-orientation=”portraint”， 声明播放器支持的方向，portraint竖屏（默认），landscape 横屏, </p>
<p>总结：内联需要以下3个属性<br>playsinline<br>webkit-playsinline<br>x5-video-player-type=’h5-page’</p>
<p>事件</p>
<p>onDurationChange<br>duration（只读）属性变化就触发</p>
<p>onLoadedData<br>加载数据就触发</p>
<p>onCanPlay<br>浏览器缓存好了数据可以播放时触发<br>拖动进度条，缓存好了数据可以播放时，会再次触发</p>
<p>onCanPlayThrough<br>浏览器缓存好了可以播放到结束的数据时触发<br>拖动进度条，缓存好了数据可以播放时，会再次触发</p>
<p>onTimeUpdate<br>播放时一直触发</p>
<p>onEnded<br>播放结束时触发</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://iamwangkj.github.io/2022/04/29/%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3-h5%E4%B8%AD%E7%9A%84video%E6%A0%87%E7%AD%BE/" data-id="clbwha4ua0009c2puavsrhxdd" data-title="深入了解-h5中的video标签" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3%E7%B3%BB%E5%88%97/" rel="tag">深入了解系列</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2021/09/09/%E9%BB%91%E8%8B%B9%E6%9E%9C%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">黑苹果安装教程</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/04/29/%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3-h5%E4%B8%AD%E7%9A%84video%E6%A0%87%E7%AD%BE/">深入了解-h5中的video标签</a>
          </li>
        
          <li>
            <a href="/2021/09/09/%E9%BB%91%E8%8B%B9%E6%9E%9C%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/">黑苹果安装教程</a>
          </li>
        
          <li>
            <a href="/2021/06/22/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93SSR/">服务端渲染SSR</a>
          </li>
        
          <li>
            <a href="/2021/06/20/%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3-Request-Headers%E4%B8%AD%E7%9A%84referer/">深入了解-Request-Headers中的referer</a>
          </li>
        
          <li>
            <a href="/2021/03/30/console%E7%9A%84%E6%AD%A3%E7%A1%AE%E6%89%93%E5%BC%80%E6%96%B9%E5%BC%8F/">console的正确打开方式</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E5%BA%94%E7%94%A8/">软件应用</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3%E7%B3%BB%E5%88%97/" rel="tag">深入了解系列</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 wangkj<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>